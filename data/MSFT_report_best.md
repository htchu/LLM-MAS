
# 量化交易策略回測報告
**股票代碼:** MSFT
**模型:** 強化學習 (PPO) + 多因子分析 (含預計算因子)
**模型檔案:** `MSFT_rl_model_best.zip`

## 數據期間
* **訓練數據:** 2000-10-16 至 2021-12-31
* **回測 (驗證) 數據:** 2022-01-03 至 2023-12-29

## 回測績效指標比較
| 指標名稱                         | 策略 (RL + 多因子) | 買入持有 (Buy & Hold) |
| -------------------------------- | ------------------- | --------------------- |
| 年化報酬率 (Annualized Return)   | 15.97%   | 12.76%      |
| 夏普比率 (Sharpe Ratio)          | 0.775     | 0.547        |
| 最大回撤 (Maximum Drawdown)      | -18.61%   | -32.07%      |
| 條件風險價值 (CVaR 95%)          | -3.27%   | -4.11%      |
| 年化波動率 (Annualized Volatility)| 22.34% | 30.33%    |
| 勝率 (Win Rate)                  | 50.00%       | N/A                   |
| 總交易次數 (Total Trades)        | 28       | 1           |
| 最終投資組合淨值 (Final Net Worth)| 1,299,800.21 USD | 1,236,729.63 USD |
| 初始資金 (Initial Balance)       | 1,000,000.00 USD | 1,000,000.00 USD |

## 交易記錄與圖表
* **詳細交易記錄:** 請參見 `MSFT_trades_best.csv` (僅適用於策略)
* **互動式交易圖表:** 請參見 `MSFT_trading_chart_best.html` (請用瀏覽器開啟，包含 Buy&Hold 比較)
* **詳細執行日誌:** 請參見 `trading_strategy.log`

## 策略說明
本策略使用強化學習代理 (PPO) 根據歷史股價 (OHLCV)、技術指標以及**預先計算**的基本面、新聞情緒、產業趨勢和市場風險因子進行交易決策 (買入/賣出/持有)。交易和評估主要基於 **收盤價 ('Close')**。報告中提供了與 **買入持有 (Buy & Hold)** 基準策略的績效比較。

**重要提示:** 因子數據的質量和預測能力直接影響策略表現。

## 風險管理機制
* **停損設置:** 5% (入場價下跌 5% 時強制賣出)
* **停利設置:** 50% (入場價上漲 50% 時強制賣出)
* **動態倉位管理:** 基於 ATR (21日) 和風險比例 (2.50%) 計算最大倉位
* **獎勵塑形:** 包含波動性懲罰和利潤獎勵機制

## 後續優化方向
* **因子質量提升:** 持續改進基本面、情緒、趨勢等因子的計算和分析方法，探索更有效的 Alpha 因子。
* **LLM/MAS 整合:** 探索使用 LLM 自動化因子生成或構建 MAS 進行協同分析與決策。
* **特徵工程:** 探索更多或不同的技術指標、因子組合。
* **RL 環境優化:** 調整獎勵函數、狀態表示。
* **超參數調優:** 擴大 Optuna 試驗次數，嘗試更多超參數組合。
* **風險管理:** 實現更動態、多維度的風險控制。
* **模型集成:** 嘗試集成多個模型。
* **數據源擴展:** 引入更多元的數據。
